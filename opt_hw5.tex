\documentclass[8pt]{article} % use larger type; default would be 10pt

%\usepackage[utf8]{inputenc} % set input encoding (not needed with XeLaTeX)
%\usepackage{CJK}
\usepackage{graphicx}
\usepackage{float}
\usepackage{subfig}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{hyperref}
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{cancel}

\usepackage{mystyle}

\title{ ENGG 5501: Foundations of Optimization\\Homework 5}
\author{Alex Leontiev, 1155040702, CUHK}
\begin{document}
\maketitle
\begin{enumerate}[label=\bfseries Problem \arabic*.]
	\item\begin{enumerate}[label=(\alph*)]
			\item The optimal solution $(\overline{x},\overline{y})$
				to $(Q_2)$ (which exists by the compactness of $[0,3]^n\subset\mathbb{R}^n$ and 
				the continuity of $f_n$ on $[0,3]^n$ for $p>2$) can clearly lie either in the interior of $[0,3]\times[0,3]$,
				or on its boundary. In the first case, the partial derivatives of 
				\[f_2(x,y)=x^{1/p}(3-y)^{1/p}+y^{1/p}(3-x)^{1/p}\]
				are well-defined, and they should both be zero at $(\overline{x},\overline{y})$ as a necessary condition,
				thus yielding the system, which should be satisfied by $x:=\overline{x}$ and $y:=\overline{y}$
				\[\left\{\begin{array}{l}
					(f_2)_x=\frac{1}{p}x^{-\frac{p-1}{p}}(3-y)^{\frac{1}{p}}
					-\frac{1}{p}y^{\frac{1}{p}}(3-x)^{-\frac{p-1}{p}}=0\iff 
					\mybra{\frac{3-y}{y}}^{\frac{1}{p}}=\mybra{\frac{3-x}{x}}^{-\frac{p-1}{p}}=
					{\frac{x}{3-x}}\mybra{\frac{3-x}{x}}^{\frac{1}{p}}\\
					(f_2)_y=-\frac{1}{p}x^{\frac{1}{p}}(3-y)^{-\frac{p-1}{p}}+\frac{1}{p}y^{-\frac{p-1}{p}}(3-x)^{\frac{1}{p}}=0
					\iff\mybra{\frac{3-x}{x}}^{\frac{1}{p}}=\mybra{\frac{3-y}{y}}^{-\frac{p-1}{p}}=
					{\frac{y}{3-y}}\mybra{\frac{3-y}{y}}^{\frac{1}{p}}\\
				\end{array}\right.\]
				Multiplying two rightmost equations we see that $xy=(3-x)(3-y)$ and hence $x+y=3\implies y=3-x$,
				thus the equations become
				\[\left\{\begin{array}{l}
					\mybra{\frac{x}{3-x}}^{\frac{1}{p}}={\frac{x}{3-x}}\mybra{\frac{3-x}{x}}^{\frac{1}{p}}\\
					\mybra{\frac{3-x}{x}}^{\frac{1}{p}}={\frac{3-x}{x}}\mybra{\frac{x}{3-x}}^{\frac{1}{p}}\\
				\end{array}\right.\]
				Dividing first by second one we get
				\[\mybra{\frac{x}{3-x}}^{\frac{1}{p}}=\mybra{\frac{3-x}{x}}^{-1+\frac{1}{p}}\iff
				\mybra{\frac{x}{3-x}}^{\frac{1}{p}}=\mybra{\frac{3-x}{x}}^{\frac{1}{2}}
				\]
				and as $p>2$ this implies that $x=3-x=y=3/2$. Note, that 
				\[f\mybra{\frac{1}{2},\frac{1}{2}}=2\mybra{\frac{3}{2}}^{\frac{2}{p}}\]

				Now, let us assume that the optimal solution $(\overline{x},\overline{y})$ lies on the boundary of $[0,3]^2$,
				which consists of the four segments (listed together with values of $f_2$ attained on a segment):
				\[(x,y)=(0,t),\;0\leq t\leq3,\implies f_2(0,t)=t^{1/p}3^{1/p}\leq3^{2/p}\]
				\[(x,y)=(3,t),\;0\leq t\leq3,\implies f_2(0,t)=3^{1/p}(3-t)^{1/p}\leq3^{2/p}\]
				\[(x,y)=(t,0),\;0\leq t\leq3,\implies f_2(t,0)=3^{1/p}t^{1/p}\leq3^{2/p}\]
				\[(x,y)=(t,3),\;0\leq t\leq3,\implies f_2(0,t)=3^{1/p}(3-t)^{1/p}\leq3^{2/p}\]
				Now, as $3^{2/p}$ is strictly smaller than the biggest value attainable on the interior of $[0,3]^2$, which is
				$2(3/2)^{\frac{2}{p}}$, we conclude that 
				$(\overline{x},\overline{y})=(1/2,1/2)$ and $f(\overline{x},\overline{y})=2(3/2)^{\frac{2}{p}}$.
			\item Observe, that $S$ decomposes into the disjoint union
				\[S=S_1\sqcup S_2\sqcup S_3\]
				where $S_i:=\mycbra{(x_1,x_2,x_3)\in S:\; x_i\in\mycbra{0,3}}$.
				As $f_3(x,y,z)$ is symmetric with respect to all possible permutations of 3 elements, it suffices to find the 
				maximum of $f_3$ on $S_1$ only. Therefore, let us assume that the optimal solution $(\overline{x},\overline{y},
				\overline{z})\in S$ (which exists by the compactness of $S$ and the continuity of $f_3$ on $[0,3]^3$)
				belongs in fact to $S_1$, thus $\overline{x}$ is either 0, or 3. In former case, we have that
				\[f_3(0,y,z)=3^{1/p}(y^{1/p}(3-z)^{1/p}+(3-y)^{1/p}z^{1/p})=3^{1/p}f_2(y,z)\leq 3^{1/p}\cdot2\cdot(3/2)^{2/p}\]
				by the previous subproblem (as $(y,z)\in[0,3]^2$) while latter assumption gives that
				\[f_3(3,y,z)=3^{1/p}(3-y)^{1/p}(3-z)^{1/p}\leq3^{3/p}\]
				In any case, we have $3^{1/p}\cdot2\cdot(3/2)^{2/p},\;3^{3/p}<3\cdot 2^{2/p}=f(1,1,1)$ for any $p>2$, as
				\[3^{1/p}\cdot2\cdot(3/2)^{2/p}<3\cdot 2^{2/p}\iff \frac{81}{16}<\mybra{\frac{3}{2}}^p\]
				(which is true as $p>2\implies (3/2)^p>9/4>81/16$) and
				\[3^{3/p}<3\cdot 2\iff \frac{27}{4}<3^p\]
				(which is true, as $p>2\implies 3^p>9>27/4$) which gives the desired conclusion.
		\end{enumerate}
	\item To begin with, the standard form of the dual problem would look like
		\[v_d^*=\mbox{maximize }L(u):=\inf_{x}\mybra{x^TAx+2b^Tx+u(x^Tx-1)}\]
		\[\mbox{subject to }u\geq0\]
		and in subsequent we will show the equivalence to the desired form. First of all, as $\inf_x\mybra{
		x^TAx+2b^Tx+u(x^Tx-1)}=\inf_x\mybra{x^TAx+2b^Tx+ux^Tx}-u$ the dual problem is readily equivalent to
		\[v_d^*=\mbox{maximize }-t-u\]
		\[\mbox{subject to }u\geq0\]
		\[-t=\inf_{x}\mybra{x^TAx+2b^Tx+ux^Tx}\]

		Note, that if for fixed $u$, $A+uI$ is strictly positive definite, then $\inf_{x}\mybra{x^TAx+2b^Tx+ux^Tx}=
		\inf_x\mybra{x^T(A+uI)x+2b^Tx}>-\infty$, as then given $A:=\inf_{\mynorm{x}=1}\mybra{x^T(A+uI)x}>0$, we have
		$x^T(A+uI)x+2b^Tx\geq L\mynorm{x}^2-2\mynorm{b}\mynorm{x}\to+\infty$ as $\mynorm{x}\to\infty$, hence there is compact
		$D\subset\mathbb{R}^n$ (which can be taken to be closed ball centered around $0$, for example), such that outside $D$ 
		$x^T(A+uI)x+2b^Tx>0$, thus $\inf_x\mybra{x^T(A+uI)x+2b^Tx}=\inf_{x\in D}\mybra{x^T(A+uI)x+2b^Tx}>-\infty$.

		Moreover, if for fixed $u$, 
		for some  $x_0\neq 0$ we have $x^T(A+uI)x<0$, we have 
		\[-t=\inf_{x}\mybra{x^TAx+2b^Tx+ux^Tx}\leq\inf_{\lambda\geq0}
		\mybra{(\lambda x_0)^T(A+uI)(\lambda x_0)+2b^T(\lambda x_0)}=\]
		\[=\inf_{\lambda\geq0}\mybra{\lambda^2x_0^T(A+uI)x_0+2\lambda b^Tx_0}\leq\lim_{\lambda\to\infty}
		\mybra{\lambda^2x_0^T(A+uI)x_0+2\lambda\mynorm{x}\mynorm{b}}=-\infty\]

		Furthermore, $v_d^*>-\infty$, as for big $u$, $A+uI$ becomes strictly positive definite, hence $t$ becomes bigger than
		$-\infty$. Thus, the we can add additional constraint $t>-\infty$, while remaining in the same equivalence class,
		and from the previous paragraph, this will imply that $A+uI\succeq0$, so that problem below is equivalent to previous
		\[v_d^*=\mbox{maximize }-t-u\]
		\[\mbox{subject to }u\geq0\]
		\[-t=\inf_{x}\mybra{x^TAx+2b^Tx+ux^Tx}\]
		\[A+uI\succeq0\]

		Now, the fact that $-t=\inf_{x}\mybra{x^TAx+2b^Tx+ux^Tx}$ implies that $-t\leq{x^TAx+2b^Tx+ux^Tx}$, and 
		conversely, as we seek to maximize $-t-u$, for fixed $u$, we will try to make $-t$ as big as possible, hence
		the constraint $-t=\inf_{x}\mybra{x^TAx+2b^Tx+ux^Tx}$ can be relaxed to $-t\leq{x^TAx+2b^Tx+ux^Tx}$, thus
		yielding the equivalent problem 
		\[v_d^*=\mbox{maximize }-t-u\]
		\[\mbox{subject to }u\geq0\]
		\[-t\leq{x^TAx+2b^Tx+ux^Tx}\mybra{\iff x^TAx+u\mynorm{x}^2+t+2b^Tx\geq 0}\]
		\[A+uI\succeq0\]
		Finally, the fact that 
		\[\begin{bmatrix}A+uI&b\\b^T&t\end{bmatrix}\succeq0\]
		means that $\forall x\in\mathbb{R}^n,\;y\in\mathbb{R}$ we have
		\[x^TAx+u\mynorm{x}^2+ty^2+y\cdot2b^Tx\geq0\]
		Now, by scaling argument, we can assume that $y=0$ or $y=1$, thus above is equivalent to two conditions
		\[\begin{cases}
			\forall x,\;x^TAx+u\mynorm{x}^2+t+2b^Tx\geq0\\
			\forall x',\;x'^TAx'+u\mynorm{x'}^2\geq0\mybra{\iff A^T+uI\succeq0}
		\end{cases}\]
		which are {\it precisely} the two last conditions we had in our system, hence it is equivalent to
		\[v_d^*=\mbox{maximize }-t-u\]
		\[\mbox{subject to }u\geq0\]
		\[\begin{bmatrix}A+uI&b\\b^T&t\end{bmatrix}\succeq0\]
		thus finishing the proof.
	\item\begin{enumerate}[label=(\alph*)]
				\newcommand{\prox}{\mbox{prox}}
			\item To show that if $x^*$ is the optimal solution to Problem (3), $x^*=\prox_1(x^*-\nabla f(x^*))$, we 
				will assume that for some $y\neq x^*$ we have $g(y)+\frac{1}{2}\mynorm{x^*-\nabla f(x^*)-y}^2\leq
				g(x^*)+\frac{1}{2}\mynorm{x^*-\nabla f(x^*)-x^*}^2$ and will bring this to contradiction. The
				latter inequality can be expanded to
				\[g(y)+\frac{1}{2}\mynorm{x^*-y}^2-(x^*-y)^T\cdot\nabla f(x^*)+
				\cancel{\frac{1}{2}\mynorm{\nabla f(x^*)}^2}\leq
				g(x^*)+\cancel{\frac{1}{2}\mynorm{\nabla f(x^*)}^2}\]
				As $y\neq x^*$ by assumption, $\mynorm{x^*-y}^2>0$, hence the previous inequality implies
				\[g(y)-(x^*-y)^T\cdot\nabla f(x^*)<g(x^*)\]
				Now, by translating, we may assume that $x^*=0$ and by adding constant to $g$ (which won't effect
				convexity), we may assume also that $g(x^*)=g(0)=0$. Also, by adding constant to $f$ we may assume
				$f(x^*)=f(0)=0$. Then, the previous inequality becomes
				\[g(y)+y^T\cdot\nabla f(0)<g(0)=0\]
				%By convexity of $g$, we have for any $1>\alpha>0$, that $g(\alpha y)\leq \alpha g(y)$.
				For $\alpha\to0+$ the previous inequality implies
				\[\alpha g( y)+(\alpha y)^T\cdot\nabla f(0)<0\]
				Finally, as for small $\alpha>0$ we have
				\[f(\alpha y)-f(0)-(\alpha y)^T\cdot\nabla f(0)=
				f(\alpha y)-(\alpha y)^T\cdot\nabla f(0)=\epsilon(\alpha)\cdot
				{\alpha},\;\lim_{\alpha\to0+}\epsilon(\alpha)=0\]
				Thus previous inequality becomes
				\[\alpha g( y)+f(\alpha y)-\epsilon(\alpha)\cdot{\alpha}<0\]
				as $\epsilon(\alpha)\to 0$, this implies
				\[\alpha g( y)+f(\alpha y)<0\]
		\end{enumerate}
\end{enumerate}
\end{document}
